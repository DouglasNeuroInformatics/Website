---
import { getCollection } from 'astro:content';

import PageHeading from '@/components/PageHeading.astro';
import type { CurrentTeamMember } from '@/components/TeamMembers.astro';
import TeamMembers from '@/components/TeamMembers.astro';
import { useTranslations } from '@/i18n';
import Layout from '@/layouts/Layout.astro';
import type { CollectionEntry } from 'astro:content';

const team = (
  (await getCollection('team', ({ data }) => data.position)) as (CollectionEntry<'team'> & {
    data: CurrentTeamMember;
  })[]
).map(({ data }) => data);

team.sort((a, b) => {
  if (a.seniority > b.seniority) {
    return 1;
  } else if (b.seniority > a.seniority) {
    return -1;
  }
  return 0;
});

const coreTeam = team.filter(({ type }) => type === 'core-team-member');
const d3smCoordinators = team.filter(({ type }) => type === 'd3sm-coordinator');

export const getStaticPaths = () => {
  return [{ params: { locale: 'en' } }, { params: { locale: 'fr' } }];
};

const { t } = useTranslations(Astro.url);
---

<Layout
  bilingual
  description={t({
    en: 'Meet the Douglas Neuroinformatics Platform team at the Douglas Research Centre. We provide cutting-edge informatics resources, technical support, and expertise to enable measurement-based care and research.',
    fr: "Rencontrez l'équipe du Douglas Neuroinformatics Platform au Centre de recherche Douglas. Nous fournissons des ressources informatiques de pointe, du soutien technique et de l'expertise pour permettre des soins et de la recherche fondés sur des mesures."
  })}
  title={t({
    en: 'Douglas Neuroinformatics Platform - Team',
    fr: "Douglas Neuroinformatics Platform - L'équipe"
  })}
>
  <PageHeading>
    {
      t({
        en: 'Meet Our Team',
        fr: 'Rencontrez notre équipe'
      })
    }
  </PageHeading>
  <TeamMembers people={coreTeam} />
</Layout>
